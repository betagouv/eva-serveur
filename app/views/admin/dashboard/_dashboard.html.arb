# frozen_string_literal: true

if current_compte.validation_refusee?
  render 'validation_refusee'
elsif prise_en_main.en_cours?
  render partial: "admin/dashboard/prise_en_main/etape_#{prise_en_main.numero_etape}",
         locals: { campagne: campagnes.first }
elsif current_compte.validation_en_attente?
  render 'validation_necessaire'
end

if evaluations.present?
  columns do
    column do
      render 'evaluations', evaluations: evaluations
    end
    column do
      render 'actualites', actualites: actualites if actualites.present?
    end
  end
end

if campagnes.present?
  columns do
    render 'campagnes', campagnes: campagnes
  end
end

if can?(:manage, Compte)
  panel t('.statistiques.titre'), class: 'panel--transparent' do
    text_node tag.iframe(nil, src: 'https://metabase.eva.beta.gouv.fr/public/dashboard/f9549f07-b9a1-4fe7-8961-2a127bf27d22',
                              frameborder: 0,
                              width: '100%',
                              height: 600,
                              allowtransparency: true)
  end
end
