# frozen_string_literal: true

div class: 'row' do
  div class: 'structure offset-1 col-4' do
    div class: 'bloc-structure-infos' do
      h2 structure.nom, class:'titre-entete-page'

      render 'components/panel_introduction',
             text: t('.introduction', lien_aide: admin_aide_path),
             image: 'bienvenue.png'

      div class: 'panel' do
        attributes_table_for structure do
          row :nom
          if structure.instance_of?(StructureLocale)
            row :type_structure do
              traduction_type_structure(structure.type_structure)
            end
            row :code_postal
            row :region
          end
          row :created_at
        end
      end

      structures = if structure.instance_of?(StructureLocale)
                     structure
                   else
                     structures_dependantes
                   end
      render partial: 'admin/structures/statistique',
             locals: { structures: structures }

      if can?(:manage, Compte)
        panel 'Administration' do
          attributes_table_for structure do
            row :id
            row :latitude
            row :longitude
            row :updated_at
            row :structure_referente
            if structure.instance_of?(StructureAdministrative)
              row :structures_dependantes do
                structures_dependantes
              end
            end
          end
        end
      end
    end

    render 'admin/structures/membres'

    render partial: 'admin/structures/mes_campagnes',
           locals: { campagnes: campagnes }

    active_admin_comments_for(resource)
  end
end
