<%# frozen_string_literal: true %>

<%= dsfr_modal(title: t(".titre").html_safe, html_attributes: { id: "fr-modal-#{compte.id}" }) do %>
  <%= form_with url: verifier_admin_compte_path(compte), method: :patch, local: true do |f| %>
    <div class="modal-role-utilisateur">
      <%= md t(".introduction", compte: compte.display_name, structure: current_compte.structure.nom) %>
      <div class="fr-select-group fr-mb-4">
        <fieldset class="fr-fieldset" id="role-selection" aria-labelledby="role-selection-legend">
          <legend class="fr-fieldset__legend fr-fieldset__legend--regular" id="role-selection-legend">
            Choisissez un r√¥le :
          </legend>

          <% roles_avec_description.each do |libelle, role, description| %>
            <div class="fr-fieldset__element">
              <div class="fr-radio-group fr-radio-group--sm">
                <%= f.radio_button :role, role, id: "role_#{role}_#{compte.id}" %>
                <%= f.label :role, libelle, class: "fr-label", for: "role_#{role}_#{compte.id}" %>
                <% if description.present? %>
                <p class="fr-mb-0 fr-ml-3w fr-hint-text"><%= description %></p>
                <% end %>
              </div>
            </div>
          <% end %>

          <div class="fr-messages-group" id="role-selection-messages" aria-live="assertive"></div>
        </fieldset>
      </div>

      <div class="fr-modal__footer">
        <button type="submit" name="decision" value="Refuser" class="fr-btn bouton-secondaire">
          Refuser
        </button>
        <button type="submit" name="decision" value="Autoriser" class="fr-btn fr-m-0" id="valider-modal-verification">
          Autoriser
        </button>
      </div>
    </div>
  <% end %>
<% end %>
