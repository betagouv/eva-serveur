# frozen_string_literal: true

panel structure.nom do
  attributes_table_for structure do
    row :code_postal
    row :nom
    row(:type_structure) do
      traduction_type_structure(structure.type_structure)
    end
    row :region
    row :created_at
  end
end

if can?(:manage, Compte)
  panel 'Administration' do
    attributes_table_for structure do
      row :id
      row :latitude
      row :longitude
      row :updated_at
    end
  end
end

h3 'Mes coll√®gues'
h4 'En attente'
table_for comptes.validation_en_attente,
          class: 'index_table hide_inventory' do
  column(:nom_complet) do |compte|
    compte.nom_complet.presence || 'Nom inconnu'
  end
  column :email
  column :actions do |compte|
    div class: 'table_actions actions_visibles' do
      (link_to 'Autoriser', autoriser_admin_compte_path(compte),
               method: :patch,
               class: 'autoriser_link') +
        (link_to 'Refuser', refuser_admin_compte_path(compte),
                 method: :patch,
                 class: 'refuser_link')
    end
  end
end

h4 'Autre'
table_for comptes.not_validation_en_attente, class: 'index_table' do
  column(:nom_complet) do |compte|
    compte.nom_complet.presence || 'Nom inconnu'
  end
  column :email
  column :statut_validation
  column :actions do |compte|
    div class: 'table_actions' do
      link_to t('.voir'), admin_compte_path(compte), class: 'view_link'
    end
  end
end

h3 'Campagnes'
table_for campagnes, class: 'index_table' do
  column :libelle
  column :code
  column :nombre_evaluations
  column :actions do |campagne|
    div class: 'table_actions' do
      link_to t('.voir'), admin_campagne_path(campagne), class: 'view_link'
    end
  end
end
