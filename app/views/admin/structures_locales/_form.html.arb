# frozen_string_literal: true

render partial: 'nouvelles_structures/modal_mise_en_garde' if params[:mise_en_garde] == 'affiche'
div class: 'panel nouvelle_structure' do
  h2 t('.titre')
  active_admin_form_for [:admin, resource] do |f|
    f.inputs do
      f.object.code_postal = params[:code_postal]&.delete('^0-9') if f.object.code_postal.blank?
      f.input :code_postal, wrapper_html: { class: 'autocomplete-code-postal' }
      f.input :nom, wrapper_html: { class: 'autocomplete-nom-structure' }
      f.input :type_structure, as: :select, collection: collection_types_structures
      f.input :siret, wrapper_html: { class: 'autocomplete-siret' }
      if can?(:manage, Compte)
        f.input :parent_id, as: :select, collection: StructureAdministrative.all
      end
    end
    text_node md t('.verifier_information_structure')
    f.actions do
      f.action :submit
      annulation_formulaire(f) if current_compte.structure.present?
    end
  end
end
