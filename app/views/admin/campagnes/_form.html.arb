# frozen_string_literal: true

render 'form_script'
div class: 'nouvelle-campagne' do
  div class: 'row' do
    div class: 'offset-1 col-4' do
      titre = resource.new_record? ? 'new' : 'edit'
      h1 t("active_admin.resources.campagne.#{titre}_model")
      div class: 'panel description' do
        md t('.explication_campagne')
      end

      active_admin_form_for [:admin, resource] do |f|
        f.semantic_errors
        h2 t('.titre_libelle')
        div class: 'panel' do
          f.inputs do
            f.input :libelle
          end
        end

        h2 'Programme'
        div class: 'panel' do
          f.inputs class: 'input-choix-type-programme' do
            f.input :types_programme,
                    as: :radio,
                    collection: collection_types_programme,
                    label: false
          end
        end

        if resource.new_record?
          div id: 'zone-choix-programme', class: f.object.parcours_type_id.present? ? '' : 'hidden' do
            h2 t('.choix_programme')
            div class: 'panel' do
              div class: 'description description--secondaire m-0' do
                md t('.explication_choix_programme')
              end

              div class: 'pre-positionnement hidden' do
                h2 t('.pre_positionnement'), class: 'titre-categorie'
                div class: 'description description--secondaire m-0' do
                  md t('.explication_pre_positionnement')
                end
                f.inputs class: 'input-choix input-choix-option-parcours_type' do
                  collection = collection_parcours_type(parcours_type.pre_positionnement)
                  f.input :parcours_type, as: :radio,
                                          collection: collection,
                                          required: true,
                                          label: false
                end
              end

              div class: 'evaluation-avancee hidden' do
                h2 t('.evaluation_avancee'), class: 'titre-categorie'
                div class: 'description description--secondaire m-0' do
                  md t('.explication_evaluation_avancee')
                end
                f.inputs class: 'input-choix input-choix-option-parcours_type' do
                  collection = collection_parcours_type(parcours_type.evaluation_avancee)
                  f.input :parcours_type, as: :radio,
                                          collection: collection,
                                          required: true,
                                          label: false
                end
              end
            end
          end

          if resource.new_record?
            div id: 'zone-de-personnalisation',
                class: f.object.parcours_type_id.present? ? '' : 'hidden' do
              h2 t('.personnalisation')
              div class: 'panel' do
                para t('.explication_personnalisation'),
                     class: 'description description--secondaire'
                f.inputs class: 'input-choix input-choix-option-personnalisation' do
                  f.input :options_personnalisation,
                          as: :check_boxes,
                          collection: collection_options_personnalisation,
                          label: false
                end
              end
            end
          end
        end

        if current_compte.superadmin?
          div class: 'panel' do
            h2 t('.configuration_avancee')
            f.inputs do
              f.input :compte
              f.input :code
              f.input :affiche_competences_fortes
              f.input :questionnaire
              if resource.persisted?
                render partial: 'admin/situations_configurations/input_situations_configurations',
                       locals: { f: f }
              end
            end
          end
        end

        f.actions do
          annulation_formulaire(f)
          f.action :submit
        end
      end
    end
  end
end
